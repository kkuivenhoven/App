<p id="notice"><%= notice %></p>

<% provide(:title, "Ratings") %>
<% provide(:p, "Below are the skate spots that have been rated by users.") %>
<% provide(:text, "Select how you would like to sort the ratings") %>

	<!--% @grouped_ratings.each do |key, g_r| %>
					% @avgDiff = g_r.map {|i| i.difficulty} %><br>
					%= @avgDiff.reduce(:+) / @avgDiff.size.to_f %>
	% end %-->

	<!--%= @testing.average('difficulty') %><br><br>
		% @testing.each do |t| %>
						%= t.inspect %><br><br>
		% end %-->

		<!--% @grouped_ratings.each do |key, g_r| %>
						% @diff = g_r.collect { |h| h.values_at("difficulty") } %>
						% @diff = @diff.flatten %-->
						<!--% @diff.mean %-->
						<!--% g_r.collect { |h| h.values_at("difficulty") } %>
						<br-->

		  <!--% @g_rate = @skate_spots.find_by(:id => key) %> 
			% @diff = Array.new %>
			%= g_r %><br><br-->
			<!--%= @g_rate.name %><br>
			%= g_r %><br>
			%= g_r.class %><br>
			% g_r.each do |g| %>
				% @diff << g.difficulty %>
				%= g.class %><br>
			% end %>
			%= @diff %>
			<br><br>
		% end %-->

<div class="table-responsive">
<table class="table skate_table" id="rateTable">
  <thead>
    <tr>
      <th onclick="sortnameTable(0)">Name</th>
      <th onclick="sortthenums(2)">Difficulty</th>
      <th onclick="sortthenums(3)">Security</th>
      <th onclick="sortthenums(4)">Pedestrian</th>
			<th>Spot&nbsp;type</th>
		  <th><center>Description</center></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @ratings.each do |rating| %>
    <!--% @grouped_ratings.each do |key, g_r| %>
		% g_r.each do |rating| %-->
		<% @s_rate = @skate_spots.find_by(:id => rating.skate_spot_id) %> 
      <tr>
					<td style="display: none"><%= @s_rate.name %></td>
					<td><span class="skate_link"><%= link_to "#{@s_rate.name}", @s_rate %></span></td>
					<td><%= rating.difficulty %></td>
					<td><%= rating.police %></td>
					<td><%= rating.pedestrian %></td>
					<td>
							<% if @s_rate.park_spot %>
									<center>Park&nbsp;spot</center>
							<% elsif @s_rate.street_spot %>
									<center>Street&nbsp;spot</center>
							<% else %>
									<center>Type of spot&nbsp;not indicated</center>
							<% end %>
					</td>
			    <td><%= rating.description %></td>
   
        <!-- /skate_spots/:skate_spot_id/ratings/:id -->
        <!--td>%= link_to 'Show', [rating.skate_spot, rating] %></td-->
        <!-- instead of: <td>%= link_to 'Show', rating %></td> -->
        <!-- /skate_spots/:skate_spot_id/ratings/:id/edit -->
        <!--td>%= link_to 'Edit', edit_skate_spot_rating_path(rating.skate_spot, rating) %></td-->
        <!-- instead of: <td>%= link_to 'Edit', edit_rating_path(rating) %></td> -->
        <!-- /skate_spots/:skate_spot_id/ratings/:id -->
        <!--td>%= link_to 'Destroy', [rating.skate_spot, rating], method: :delete, data: { confirm: 'Are you sure?' } %></td-->
        <!-- instead of: <td>%= link_to 'Destroy', rating, method: :delete, data: { confirm: 'Are you sure?' } %></td> -->
      </tr>
    <!--% end %-->
    <% end %>
  </tbody>
</table>





