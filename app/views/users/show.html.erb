<!--Sources:
https://www.railstutorial.org/book, Hartl Michael, 2014
https://www.railstutorial.org/book/sign_up-->

<% provide(:title, @user.name) %>
<% if current_user.id == @user.id %>
    <% provide(:p, "Your documented street spots: #{@user.skate_spots.count}") %>
<% elsif current_user.following?(@user) %>
		<% provide(:p, "#{@user.name}'s documented street spots: #{@user.skate_spots.count}") %>
<% else %>
		<% provide(:p, "Follow #{@user.name}'s to see documented street spots, ratings, and more.") %>
<% end %>

<div class="row">
 <div class="col-sm-4">
  <!--<aside class="col-md-4">-->
    <section class="user_info">
      <h3>
        <%= gravatar_for @user %>
				<%= render 'follow_form' if logged_in? %>
        <div class="col-sm-2">
          <!--%= @user.name %-->
          <!--%= @user.email %-->
        </div>
      </h3>
    </section>
        <section class="stats">
           <%= render 'shared/stats' %>
				</section>
  <!--</aside>-->
 </div>
<!--</div>-->

<div class="container" id="RecSpaceDiv">
	<div class="row">
	</div>
</div>
<%= render partial: 'users/event' %>

<% if (current_user.id == @user.id) || (current_user.following?(@user)) %>
				<div class="container">
				<center><h5>Skate Spots you have created</h5></center>
					<div class="table-responsive">
						<table class="table skate_table">
						 <thead>
							 <tr>
								 <th>Name</th>
								 <th>Gated</th>
								 <th>Material</th>
								 <th>Type</th>
								 <th>Size</th>
								 <th>Address</th>
							 </tr>
						 </thead>
				 
						<tbody>
						 <% @user.skate_spots.each do |skate_spot| %>
							 <tr>
								<tr>
									<td>
										<li class="dropdown">
											<span class="skate_link"><%= link_to "#{skate_spot.name}", skate_spot %></span>
											<a href="#" class="dropdown-toggle caret_link" data-toggle="dropdown">
												<b class="skate_caret"></b>
											</a>
											<ul class="dropdown-menu">
												<li><%= link_to "Edit", edit_skate_spot_path(skate_spot) %></li>
											 <li><%= link_to "Destroy", skate_spot, method: :delete, data: { confirm: 'Are you sure?' } %></li>
										 </ul>
									 </li>
								 </td>


   <td>
      <% if skate_spot.gated %>Yes
      <% else %>No
      <% end %>
   </td>  
   <td>
      <% if skate_spot.wood %>Wooden
      <% elsif skate_spot.metal %>Metal
      <% elsif skate_spot.concrete %>Concrete
      <% else %>No material listed
      <% end %>
   </td>  
   <td>
      <% if skate_spot.transition %>Transition
      <% elsif skate_spot.street_plaza %>Street Plaza
      <% else %>Not listed
      <% end %>
   </td>  
   <td>
      <% if skate_spot.skate_spot_size %>Skate spot size
      <% elsif skate_spot.neighborhood_spot_size %>Neighborhood spot size
      <% elsif skate_spot.regional_spot_size %>Regional spot size
      <% else %>No size listed
      <% end %>
   </td>  


								 <td><%= skate_spot.complete_address %></td>
							 </tr>
						 </tr>
						<% end %>
					 </tbody>
					</table>
				 </div>
				</div>

				</div>


<div id="user_index_map"></div>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB-XKZoYCQoqSadvpEnrI5wqiMVR9S_9Do&callback=userinitMap">
</script>
<br>

<div class="table-responsive">
	<table class="table skate_table">
		<thead>
			<tr>
				<th>Name</th>
        <th>Difficulty</th>
        <th>Security</th>
        <th>Pedestrian</th>
        <th><center>Description</center></th>
        <th colspan="3"></th>
      </tr> 
    </thead>

    <tbody>
      <% @ratings.each do |rating| %>
      <% @s_rate = @skate_spots.find_by(:id => rating.skate_spot_id) %>
        <tr> 
            <td style="display: none"><%= @s_rate.name %></td>
            <td><span class="skate_link"><%= link_to "#{@s_rate.name}", @s_rate %></span></td>     
            <td><%= rating.difficulty %></td>
            <td><%= rating.police %></td> 
            <td><%= rating.pedestrian %></td>
            <td><%= rating.description %></td>
				</tr>
			<% end %>
  	</tbody>
  </table>
</div>

<% end %>

<!--div class="container">
  <aside class="col-md-4">
    <section class="stats">
      %= render 'shared/stats' %>
    </section>
  </aside-->
  <!--div class="col-md-8" style="background:white"-->
    <!--%= render 'follow_form' if logged_in? %-->
    <!--% if @user.microposts.any? %>
      <h3>Microposts (%= @user.microposts.count %>)</h3>
      <ol class="microposts">
        %= render @microposts %>
      </ol>
      %= will_paginate @microposts %>
    % end %-->
  <!--/div>
</div-->





<span style="visibility:hidden" id="all_latlng"><%= @all_latlng%></span>

